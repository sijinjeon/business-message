/* empty css                       */chrome.runtime.onMessage.addListener((e,t,n)=>{switch(e.action){case"PING":n({success:!0,message:"pong"});break;case"GET_SELECTED_TEXT":n({text:function(){const e=document.activeElement;if(e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement){const t=e.selectionStart??0,n=e.selectionEnd??0,s=e.value.substring(t,n);if(s)return s}const t=window.getSelection(),n=t?.toString()||"";if(!n||!t||0===t.rangeCount)return n;if(!(e instanceof HTMLElement&&e.isContentEditable))try{const e=t.getRangeAt(0),n=document.createElement("span");n.id="bca-selection-loading",n.className="bca-loading-container";const s=document.createElement("span");s.className="bca-spinner";const o=document.createElement("span");o.innerText=" 처리 중...",o.style.marginLeft="4px",o.style.fontSize="1.0em",o.style.color="#6b7280",n.appendChild(s),n.appendChild(o);const a=e.cloneRange();a.collapse(!1),a.insertNode(n)}catch(s){}return n}()});break;case"REMOVE_LOADING":const t=document.getElementById("bca-selection-loading");t&&t.remove(),n({success:!0});break;case"REPLACE_SELECTED_TEXT":!function(e,t=!1){const n=document.getElementById("bca-selection-loading");n&&n.remove();const s=document.activeElement;if(s instanceof HTMLTextAreaElement||s instanceof HTMLInputElement){const n=s.selectionStart??0,o=s.selectionEnd??0,a=s.value;if(t){const t=`${a.includes("\n")?"\n":" "}[번역] ${e}`;s.value=a.slice(0,o)+t+a.slice(o),s.selectionStart=s.selectionEnd=o+t.length}else s.value=a.slice(0,n)+e+a.slice(o),s.selectionStart=s.selectionEnd=n+e.length;return s.dispatchEvent(new Event("input",{bubbles:!0})),void s.dispatchEvent(new Event("change",{bubbles:!0}))}const o=window.getSelection();if(!o||0===o.rangeCount)return;const a=o.getRangeAt(0);if(t){a.collapse(!1);const t=document.createElement("div");t.className="bca-translation-block",t.style.display="inline-block",t.style.maxWidth="100%",t.style.verticalAlign="top",t.style.boxSizing="border-box",t.style.color="#2563eb",t.style.fontSize="0.95em",t.style.marginTop="8px",t.style.marginBottom="8px",t.style.padding="8px 12px",t.style.borderLeft="3px solid #3b82f6",t.style.backgroundColor="rgba(59, 130, 246, 0.05)",t.style.whiteSpace="pre-wrap",t.style.borderRadius="4px",t.style.lineHeight="1.6",t.style.fontFamily="sans-serif",t.style.textAlign="left",t.textContent=e;try{a.insertNode(t),o.removeAllRanges()}catch(c){a.insertNode(document.createTextNode(` [번역: ${e}]`))}}else try{document.execCommand("insertText",!1,e)||(a.deleteContents(),a.insertNode(document.createTextNode(e)))}catch(c){a.deleteContents(),a.insertNode(document.createTextNode(e))}}(e.text,e.append),n({success:!0});break;case"SHOW_TOAST":!function(e,t="info"){const n=document.getElementById("bca-toast-container");n&&n.remove();const s=document.createElement("div");s.id="bca-toast-container",Object.assign(s.style,{position:"fixed",bottom:"32px",right:"32px",maxWidth:"400px",minWidth:"200px",padding:"14px 24px",borderRadius:"14px",backgroundColor:"error"===t?"#ef4444":"#18181b",color:"#ffffff",fontSize:"16px",fontWeight:"600",wordWrap:"break-word",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",zIndex:"99999999",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",opacity:"0",transform:"translateY(20px)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'});const o="error"===t?"❌":"success"===t?"✅":"ℹ️";s.innerHTML=`<span>${o}</span> <span>${e}</span>`,document.body.appendChild(s),requestAnimationFrame(()=>{s.style.opacity="1",s.style.transform="translateY(0)"}),setTimeout(()=>{s.style.opacity="0",s.style.transform="translateY(20px)",setTimeout(()=>s.remove(),300)},3e3)}(e.message,e.type),n({success:!0});break;default:n({error:"Unknown action"})}return!0});
