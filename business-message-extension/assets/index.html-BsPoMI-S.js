import{c as e,r as s,j as a,a as t,i as n,B as r,C as i,S as o,f as l,d as c,L as d,g as x,h as m,e as h,R as p}from"./storage-service-CsB4HHqt.js";import{d as u,e as f,A as g}from"./crypto-DogMPkOD.js";import{l as b}from"./storage-DQogxH6w.js";/* empty css               */
/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=e("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),y=e("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),j=e("clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),w=e("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]),N=e("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),z=e("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),k=e("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),C=e("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),T=s.forwardRef(({className:e,...s},n)=>a.jsx("textarea",{className:t("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-4 py-3 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...s}));T.displayName="Textarea";const S=n.memo(({value:e,onChange:s,maxLength:t,placeholder:n})=>{const r=e.length,i=t>0,o=i&&r>t;return a.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[a.jsx("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:a.jsx(T,{value:e,onChange:e=>s(e.target.value),placeholder:n,className:"flex-1 min-h-0 resize-none p-4 pb-10 rounded-xl bg-zinc-50/50 border-zinc-100 transition-all duration-300 focus-visible:ring-zinc-900/5 focus-visible:ring-offset-0 focus-visible:border-zinc-300 focus-visible:bg-white font-sans text-[14px] leading-relaxed "+(o?"border-destructive focus-visible:border-destructive focus-visible:ring-destructive/10":""),maxLength:i?t+50:void 0})}),a.jsxs("div",{className:"flex items-center justify-between mt-2 px-1",children:[o?a.jsxs("p",{className:"text-[11px] text-destructive font-medium animate-in fade-in slide-in-from-top-1",children:[t,"자 이내로 줄여주세요"]}):a.jsx("span",{}),a.jsxs("span",{className:"text-[11px] font-bold px-2 py-0.5 rounded-md bg-zinc-100 "+(o?"text-destructive bg-destructive/10":"text-zinc-400"),children:[r.toLocaleString()," / ",t.toLocaleString()]})]})]})}),E=s.forwardRef(({className:e,...s},n)=>a.jsx("div",{ref:n,className:t("rounded-xl border bg-card text-card-foreground shadow",e),...s}));E.displayName="Card";const R=s.forwardRef(({className:e,...s},n)=>a.jsx("div",{ref:n,className:t("flex flex-col space-y-1.5 p-6",e),...s}));R.displayName="CardHeader";const M=s.forwardRef(({className:e,...s},n)=>a.jsx("div",{ref:n,className:t("font-semibold leading-none tracking-tight",e),...s}));M.displayName="CardTitle";s.forwardRef(({className:e,...s},n)=>a.jsx("div",{ref:n,className:t("text-sm text-muted-foreground",e),...s})).displayName="CardDescription";const L=s.forwardRef(({className:e,...s},n)=>a.jsx("div",{ref:n,className:t("p-6 pt-0",e),...s}));L.displayName="CardContent";s.forwardRef(({className:e,...s},n)=>a.jsx("div",{ref:n,className:t("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";const P={formal:"비즈니스 이메일",general:"사내 메신저",friendly:"캐주얼 채팅"},K=n.memo(({tone:e,text:t,onCopy:n,onCopyError:o,isDefaultSelected:l=!1,onConvert:c,isLoading:d=!1})=>{const[x,m]=s.useState(!1),h=P[e];return a.jsxs(E,{className:"group relative transition-all duration-300 rounded-2xl border-zinc-100 shadow-none "+(l?"bg-zinc-50/80 border-zinc-200":"bg-white hover:bg-zinc-50/30 hover:border-zinc-200"),children:[a.jsxs(R,{className:"pb-2 px-4 pt-3 flex-row items-center justify-between space-y-0",children:[a.jsxs(M,{className:"text-[13px] font-bold flex items-center gap-2 text-zinc-800",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full "+(l?"bg-zinc-900":"bg-zinc-200")}),h]}),a.jsxs("div",{className:"flex items-center gap-1",children:[l&&a.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase tracking-tight mr-1",children:"Default"}),t&&a.jsx(r,{variant:"ghost",size:"sm",onClick:async()=>{if(t)try{await n(t),m(!0),setTimeout(()=>m(!1),2e3)}catch(e){o?.("클립보드 복사에 실패했습니다.")}},className:"h-7 w-7 p-0 rounded-lg hover:bg-zinc-100 transition-colors",children:x?a.jsx(i,{className:"h-3.5 w-3.5 text-green-600"}):a.jsx(N,{className:"h-3.5 w-3.5 text-zinc-400"})})]})]}),a.jsx(L,{className:"px-4 pb-4 pt-0",children:t?a.jsx("div",{className:"font-sans text-[15px] leading-relaxed text-zinc-600 break-words break-keep-all whitespace-pre-wrap",children:t}):a.jsx("div",{className:"py-2 flex flex-col items-center justify-center border border-dashed border-zinc-200 rounded-xl bg-white/50",children:a.jsxs(r,{variant:"ghost",size:"sm",disabled:d,onClick:()=>c?.(e),className:"text-[12px] font-bold text-zinc-400 hover:text-zinc-900 gap-2 h-8 px-3",children:[d?a.jsx("div",{className:"w-3 h-3 border-2 border-zinc-200 border-t-zinc-900 rounded-full animate-spin"}):a.jsx(k,{className:"w-3 h-3"}),h," 변환"]})})})]})});async function A(){try{if(!navigator.clipboard||!navigator.clipboard.readText)throw new Error("클립보드 접근이 지원되지 않습니다.");return(await navigator.clipboard.readText()).trim()}catch(e){return""}}async function O(e){try{if(!navigator.clipboard||!navigator.clipboard.writeText)throw new Error("클립보드 접근이 지원되지 않습니다.");await navigator.clipboard.writeText(e)}catch(s){throw new Error("클립보드 복사에 실패했습니다.")}}class U extends Error{constructor(e,s,a){super(e),this.code=s,this.userMessage=a,this.name="AppError"}}function I(){const[e,a]=s.useState("idle"),[t,n]=s.useState(null),r=s.useCallback(async(e,s,t)=>{a("loading"),n(null);try{const n=await g.execute(e,s,t);return a("success"),n}catch(r){const e=function(e){return e instanceof U?e:e instanceof Error?e.message.includes("fetch")?new U("Network error","NETWORK_ERROR","네트워크 연결을 확인해주세요."):e.message.includes("429")||e.message.toLowerCase().includes("quota exceeded")?new U("Quota Exceeded","RATE_LIMIT_ERROR","AI 서비스 호출 한도를 초과했습니다. 잠시 후(약 1분) 다시 시도하거나, 설정에서 다른 모델 또는 API 키를 확인해주세요."):new U(e.message,"UNKNOWN_ERROR",e.message||"알 수 없는 오류가 발생했습니다."):new U("Unknown error","UNKNOWN_ERROR","알 수 없는 오류가 발생했습니다.")}(r);return a("error"),n(e.userMessage||e.message),null}},[]);return{execute:r,loadingState:e,error:t,reset:()=>{a("idle"),n(null)}}}function _(){const{settings:e,apiKeys:t,lastUsedTab:n,isLoading:r,updateLastUsedTab:i}=function(){const[e,a]=s.useState(null),[t,n]=s.useState({gemini:"",chatgpt:"",claude:""}),[r,i]=s.useState("tone"),[l,c]=s.useState(!0),d=s.useCallback(async()=>{c(!0);try{const e=await o.getAll();a(e.settings),i(e.lastUsedTab);const s={gemini:e.apiKeys.gemini?await u(e.apiKeys.gemini):"",chatgpt:e.apiKeys.chatgpt?await u(e.apiKeys.chatgpt):"",claude:e.apiKeys.claude?await u(e.apiKeys.claude):""};n(s)}catch(e){}finally{c(!1)}},[]);return s.useEffect(()=>{d()},[d]),{settings:e,apiKeys:t,lastUsedTab:r,isLoading:l,updateSettings:async e=>{await o.updateSettings(e),a(s=>s?{...s,...e}:null)},updateApiKey:async(e,s)=>{const a=await f(s);await o.saveApiKey(e,a),n(a=>({...a,[e]:s}))},updateLastUsedTab:async e=>{await o.update({lastUsedTab:e}),i(e)},refresh:d}}(),{execute:p,loadingState:g,error:N}=I(),[T,E]=s.useState(""),[R,M]=s.useState(null),[L,P]=s.useState({}),[U,_]=s.useState(null),[D,F]=s.useState("tone"),[V,q]=s.useState("ko"),[B,H]=s.useState("auto"),[W,$]=s.useState(""),[J,Q]=s.useState("");s.useEffect(()=>{e&&(q(e.translation.defaultTargetLanguage),F(n))},[e?.translation.defaultTargetLanguage,n]),s.useEffect(()=>{(async()=>{if(r||!e)return;const s=await chrome.storage.local.get(["lastCommand","commandTimestamp"]),a=Date.now();if(s.lastCommand&&s.commandTimestamp&&a-s.commandTimestamp<5e3){const e=await A();e&&(E(e),"translation"===s.lastCommand?(F("translation"),await i("translation"),await G(e,"translation")):"tone-conversion"!==s.lastCommand&&"_execute_action"!==s.lastCommand||(F("tone"),await i("tone"),await G(e,"tone"))),await chrome.storage.local.remove(["lastCommand","commandTimestamp"])}else if(!T){const e=await A();e&&E(e)}})()},[r,e]);const G=async(s,a)=>{const n=s||T,r=a||D;if(!n.trim()||!e)return void Y("내용을 입력해주세요.","error");const i=t[e.selectedProvider];if(!i)return void Y(`${e.selectedProvider} API 키가 설정되지 않았습니다.`,"error");const o=await p(n,"tone"===r?"tone-conversion":"translation",{provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],apiKey:i,targetLanguage:"translation"===r?V:void 0,tone:"tone"===r?e.autoCopyTone:void 0});if(o){if("tone"===r){const s=o;M(s),e.autoCopyEnabled&&s[e.autoCopyTone]&&(await O(s[e.autoCopyTone]),Y("✨ 변환 및 복사 완료","success"))}else _(o),Y("✨ 번역 완료","success");await b({provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],task:"tone"===r?"tone-conversion":"translation",inputTokens:Math.ceil(.75*n.length),outputTokens:Math.ceil(.75*("string"==typeof o?o.length:JSON.stringify(o).length))})}},X=async s=>{if(!T.trim()||!e)return;const a=t[e.selectedProvider];if(a){P(e=>({...e,[s]:!0}));try{const t=await p(T,"tone-conversion",{provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],apiKey:a,tone:s});if(t){const a=t;M(e=>({...e,...a})),Y(`✨ ${"formal"===s?"비즈니스":"general"===s?"사내":"캐주얼"} 스타일 변환 완료`,"success"),await b({provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],task:"tone-conversion",inputTokens:Math.ceil(.75*T.length),outputTokens:Math.ceil(.75*JSON.stringify(t).length)})}}finally{P(e=>({...e,[s]:!1}))}}else Y(`${e.selectedProvider} API 키가 설정되지 않았습니다.`,"error")},Y=(e,s)=>{$(e),Q(s),"success"===s&&setTimeout(()=>{$(""),Q("")},2e3)};return r?a.jsx("div",{className:"w-[800px] h-[600px] flex items-center justify-center",children:a.jsx(l,{className:"animate-spin text-zinc-400"})}):a.jsxs("div",{className:"w-[800px] h-[600px] bg-white relative flex flex-col overflow-hidden selection:bg-zinc-900/10",children:[a.jsx("header",{className:"shrink-0 border-b border-zinc-100",children:a.jsxs("div",{className:"px-5 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("div",{className:"w-7 h-7 rounded-lg bg-zinc-900 flex items-center justify-center",children:a.jsx(w,{className:"w-3.5 h-3.5 text-white"})}),a.jsx("h1",{className:"text-[13px] font-bold tracking-tight text-zinc-900",children:"BCA Assistant"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[W&&a.jsxs("div",{className:"px-2.5 py-1 rounded-full text-[11px] font-bold animate-in fade-in slide-in-from-right-2 border flex items-center gap-1.5 max-w-[250px] "+("success"===J?"bg-green-50 text-green-700 border-green-100":"bg-red-50 text-red-700 border-red-100"),children:["success"===J?a.jsx(k,{className:"w-2.5 h-2.5 shrink-0"}):a.jsx(y,{className:"w-2.5 h-2.5 shrink-0"}),a.jsx("span",{className:"truncate",children:W}),"error"===J&&a.jsx("button",{onClick:()=>{$(""),Q("")},className:"ml-0.5 hover:opacity-70 shrink-0",children:a.jsx(C,{className:"w-2.5 h-2.5"})})]}),a.jsx("button",{onClick:()=>{"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open("../options/index.html","_blank")},className:"p-1.5 rounded-lg hover:bg-zinc-100 transition-colors text-zinc-400 hover:text-zinc-600",children:a.jsx(c,{className:"w-4 h-4"})})]})]})}),a.jsx("div",{className:"shrink-0 px-5 py-3 border-b border-zinc-100 bg-zinc-50/50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex gap-1.5",children:[a.jsxs("button",{onClick:()=>{F("tone"),i("tone")},disabled:"loading"===g,className:"px-4 py-2 rounded-lg text-[12px] font-bold transition-all flex items-center gap-1.5 "+("tone"===D?"bg-zinc-900 text-white shadow-sm":"bg-white text-zinc-600 border border-zinc-200 hover:border-zinc-300"),children:[a.jsx(k,{className:"w-3.5 h-3.5"}),"톤 변환"]}),a.jsxs("button",{onClick:()=>{F("translation"),i("translation")},disabled:"loading"===g,className:"px-4 py-2 rounded-lg text-[12px] font-bold transition-all flex items-center gap-1.5 "+("translation"===D?"bg-zinc-900 text-white shadow-sm":"bg-white text-zinc-600 border border-zinc-200 hover:border-zinc-300"),children:[a.jsx(d,{className:"w-3.5 h-3.5"}),"번역"]})]}),a.jsx("div",{className:"w-px h-6 bg-zinc-200"}),"translation"===D&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(x,{value:B,onValueChange:e=>H(e),children:[a.jsx(m,{value:"auto",children:"자동"}),a.jsx(m,{value:"ko",children:"한국어"}),a.jsx(m,{value:"en",children:"English"}),a.jsx(m,{value:"ja",children:"日本語"}),a.jsx(m,{value:"zh-CN",children:"中文"})]}),a.jsx(v,{className:"w-3.5 h-3.5 text-zinc-400"}),a.jsxs(x,{value:V,onValueChange:e=>q(e),children:[a.jsx(m,{value:"ko",children:"한국어"}),a.jsx(m,{value:"en",children:"English"}),a.jsx(m,{value:"ja",children:"日本語"}),a.jsx(m,{value:"zh-CN",children:"中文"})]})]}),a.jsx("div",{className:"w-px h-6 bg-zinc-200"})]}),a.jsxs("button",{onClick:async()=>{const e=await A();e&&E(e)},className:"px-3 py-2 rounded-lg bg-white border border-zinc-200 text-[12px] font-bold text-zinc-600 hover:bg-zinc-50 hover:border-zinc-300 transition-all flex items-center gap-1.5",children:[a.jsx(j,{className:"w-3.5 h-3.5"}),"붙여넣기"]}),a.jsx("button",{onClick:()=>G(T,D),disabled:"loading"===g,className:"px-4 py-2 rounded-lg bg-zinc-900 text-white text-[12px] font-bold hover:bg-zinc-800 transition-all flex items-center gap-1.5 ml-auto disabled:opacity-50",children:"loading"===g?a.jsxs(a.Fragment,{children:[a.jsx(l,{className:"w-3.5 h-3.5 animate-spin"}),"처리 중..."]}):a.jsxs(a.Fragment,{children:[a.jsx(z,{className:"w-3.5 h-3.5"}),"tone"===D?"변환 실행":"번역 실행"]})})]})}),a.jsxs("main",{className:"flex-1 flex overflow-hidden",children:[a.jsxs("section",{className:"flex-1 flex flex-col border-r border-zinc-100",children:[a.jsx("div",{className:"px-4 py-2.5 border-b border-zinc-50 bg-white",children:a.jsx("h2",{className:"text-[10px] font-bold text-zinc-400 uppercase tracking-widest",children:"입력"})}),a.jsx("div",{className:"flex-1 p-4",children:a.jsx(S,{value:T,onChange:E,maxLength:5e3,placeholder:"다듬거나 번역할 메시지를 입력하세요..."})})]}),a.jsxs("section",{className:"flex-1 flex flex-col bg-zinc-50/30",children:[a.jsx("div",{className:"px-4 py-2.5 border-b border-zinc-100 bg-white/50",children:a.jsx("h2",{className:"text-[10px] font-bold text-zinc-400 uppercase tracking-widest",children:"tone"===D?"톤 변환 결과":"번역 결과"})}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:[N&&a.jsxs("div",{className:"p-3 rounded-xl bg-red-50 border border-red-100 text-red-700 mb-3 flex items-start gap-2",children:[a.jsx(y,{className:"w-3.5 h-3.5 mt-0.5 shrink-0"}),a.jsx("p",{className:"text-[13px] font-medium",children:N})]}),"loading"===g?a.jsxs("div",{className:"h-full flex flex-col items-center justify-center animate-in fade-in duration-500",children:[a.jsx("div",{className:"bca-gradient-spinner mb-3"}),a.jsx("p",{className:"text-[12px] font-bold text-zinc-400 animate-pulse",children:"AI가 응답을 생성하고 있습니다..."})]}):a.jsxs(a.Fragment,{children:["tone"===D&&R&&a.jsxs("div",{className:"space-y-2.5",children:[a.jsx(K,{tone:"formal",text:R.formal,onCopy:O,onCopyError:e=>Y(e,"error"),isDefaultSelected:"formal"===e?.autoCopyTone,onConvert:X,isLoading:L.formal}),a.jsx(K,{tone:"general",text:R.general,onCopy:O,onCopyError:e=>Y(e,"error"),isDefaultSelected:"general"===e?.autoCopyTone,onConvert:X,isLoading:L.general}),a.jsx(K,{tone:"friendly",text:R.friendly,onCopy:O,onCopyError:e=>Y(e,"error"),isDefaultSelected:"friendly"===e?.autoCopyTone,onConvert:X,isLoading:L.friendly})]}),"translation"===D&&U&&a.jsxs("div",{className:"p-4 rounded-xl border border-zinc-100 bg-white space-y-3 shadow-sm",children:[a.jsx("p",{className:"font-sans text-[14px] leading-relaxed text-zinc-900 whitespace-pre-wrap",children:U}),a.jsx("div",{className:"flex justify-end border-t border-zinc-50 pt-3",children:a.jsxs("button",{onClick:()=>{O(U),Y("✨ 복사 완료","success")},className:"px-3 py-1.5 bg-zinc-900 text-white rounded-lg text-[11px] font-bold hover:bg-zinc-800 transition-colors flex items-center gap-1.5",children:[a.jsx(h,{className:"w-3 h-3"}),"복사"]})})]}),"idle"===g&&!R&&!U&&a.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-zinc-300",children:[a.jsx(k,{className:"w-8 h-8 mb-3 opacity-10"}),a.jsx("p",{className:"text-[12px] font-medium",children:"메시지를 입력하고 실행하세요"})]})]})]})]})]})]})}p.createRoot(document.getElementById("root")).render(a.jsx(n.StrictMode,{children:a.jsx(_,{})}));
