import{r as e,S as t,j as o,R as a,a as r}from"./storage-service-2CRBhYrw.js";import{d as n,e as s,A as i}from"./crypto-DogMPkOD.js";import{l}from"./storage-DQogxH6w.js";/* empty css               */async function d(){try{if(!navigator.clipboard||!navigator.clipboard.readText)throw new Error("í´ë¦½ë³´ë“œ ì ‘ê·¼ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");return(await navigator.clipboard.readText()).trim()}catch(e){return""}}async function c(e){try{if(!navigator.clipboard||!navigator.clipboard.writeText)throw new Error("í´ë¦½ë³´ë“œ ì ‘ê·¼ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");await navigator.clipboard.writeText(e)}catch(t){throw new Error("í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}}class p extends Error{constructor(e,t,o){super(e),this.code=t,this.userMessage=o,this.name="AppError"}}function u(){const[t,o]=e.useState("idle"),[a,r]=e.useState(null),n=e.useCallback(async(e,t,a)=>{o("loading"),r(null);try{const r=await i.execute(e,t,a);return o("success"),r}catch(n){const e=function(e){return e instanceof p?e:e instanceof Error?e.message.includes("fetch")?new p("Network error","NETWORK_ERROR","ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”."):e.message.includes("429")||e.message.toLowerCase().includes("quota exceeded")?new p("Quota Exceeded","RATE_LIMIT_ERROR","AI ì„œë¹„ìŠ¤ í˜¸ì¶œ í•œë„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„(ì•½ 1ë¶„) ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜, ì„¤ì •ì—ì„œ ë‹¤ë¥¸ ëª¨ë¸ ë˜ëŠ” API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."):new p(e.message,"UNKNOWN_ERROR",e.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."):new p("Unknown error","UNKNOWN_ERROR","ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}(n);return o("error"),r(e.userMessage||e.message),null}},[]);return{execute:n,loadingState:t,error:a,reset:()=>{o("idle"),r(null)}}}const f=[{key:"formal",label:"ë¹„ì¦ˆë‹ˆìŠ¤",emoji:"ðŸ’¼"},{key:"general",label:"ì‚¬ë‚´ í˜‘ì—…",emoji:"ðŸ¢"},{key:"friendly",label:"ìºì£¼ì–¼",emoji:"ðŸ˜Š"}],x=[{key:"ko",label:"í•œêµ­ì–´",emoji:"ðŸ‡°ðŸ‡·"},{key:"en",label:"English",emoji:"ðŸ‡ºðŸ‡¸"},{key:"ja",label:"æ—¥æœ¬èªž",emoji:"ðŸ‡¯ðŸ‡µ"},{key:"zh-CN",label:"ä¸­æ–‡",emoji:"ðŸ‡¨ðŸ‡³"}],g={popupContainer:{width:"480px",height:"600px",display:"flex",flexDirection:"column",background:"#ffffff",borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)",border:"1px solid #f1f5f9",overflow:"hidden",fontFamily:"'Inter', 'Noto Sans KR', sans-serif"},dragHeader:{cursor:"grab",background:"linear-gradient(to right, #ffffff, #f8fafc)",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",borderBottom:"1px solid #f1f5f9"},headerLeft:{display:"flex",alignItems:"center",gap:"8px"},logoBox:{background:"#2563eb",padding:"4px",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},title:{fontSize:"14px",fontWeight:700,color:"#1e293b",margin:0},headerRight:{display:"flex",alignItems:"center",gap:"8px"},iconButton:{color:"#94a3b8",padding:"6px",borderRadius:"6px",border:"none",background:"transparent",cursor:"pointer",transition:"all 0.2s",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},scrollableMain:{flex:1,overflowY:"auto",padding:"16px",scrollbarGutter:"stable",display:"flex",flexDirection:"column",gap:"24px"},nav:{display:"flex",borderBottom:"1px solid #f1f5f9"},modeTab:{flex:1,padding:"8px",fontSize:"12px",fontWeight:600,background:"transparent",border:"none",borderBottom:"2px solid transparent",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",color:"#94a3b8"},modeTabActive:{color:"#2563eb",borderBottomColor:"#2563eb"},optionsPanel:{minHeight:"40px"},optionChip:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:500,border:"1px solid #e2e8f0",borderRadius:"9999px",background:"transparent",cursor:"pointer",transition:"all 0.2s",color:"#64748b"},optionChipActive:{background:"#eff6ff",borderColor:"#3b82f6",color:"#1d4ed8"},sectionLabel:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},labelText:{fontSize:"11px",fontWeight:700,textTransform:"uppercase",letterSpacing:"0.1em",color:"#64748b"},labelTextBlue:{color:"#2563eb"},inputBoxShared:{width:"100%",minHeight:"140px",padding:"16px",fontSize:"14px",lineHeight:1.6,borderRadius:"12px",border:"1px solid #e2e8f0",outline:"none",transition:"all 0.2s ease",resize:"none",fontFamily:"'Inter', 'Noto Sans KR', sans-serif",boxSizing:"border-box"},inputSource:{background:"#f8fafc",color:"#334155"},inputResult:{background:"rgba(239, 246, 255, 0.4)",color:"#1e293b",borderColor:"#dbeafe"},resultWrapper:{position:"relative"},copyOverlay:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"4px"},copyButton:{background:"#ffffff",padding:"6px",borderRadius:"8px",border:"1px solid #e2e8f0",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",color:"#64748b",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center"},footer:{flexShrink:0,padding:"16px",background:"#f8fafc",borderTop:"1px solid #f1f5f9",display:"flex",alignItems:"center",justifyContent:"space-between"},kbd:{padding:"2px 6px",borderRadius:"4px",border:"1px solid #e2e8f0",background:"#ffffff",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",fontSize:"10px",fontFamily:"monospace"},cancelButton:{padding:"8px 16px",fontSize:"12px",fontWeight:700,color:"#475569",background:"transparent",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},primaryButton:{padding:"8px 24px",fontSize:"12px",fontWeight:700,color:"#ffffff",background:"#2563eb",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(37, 99, 235, 0.3)",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"8px"},statusMessage:{padding:"6px 10px",borderRadius:"9999px",fontSize:"10px",fontWeight:700,display:"flex",alignItems:"center",gap:"6px",maxWidth:"180px"},statusSuccess:{background:"#f0fdf4",color:"#15803d",border:"1px solid #bbf7d0"},statusError:{background:"#fef2f2",color:"#dc2626",border:"1px solid #fecaca"},loading:{display:"flex",alignItems:"center",justifyContent:"center",width:"480px",height:"600px",background:"#ffffff"},spinner:{width:"24px",height:"24px",border:"2px solid #e2e8f0",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 0.8s linear infinite"}};function b(){const{settings:a,apiKeys:r,lastUsedTab:i,isLoading:p,updateLastUsedTab:b}=function(){const[o,a]=e.useState(null),[r,i]=e.useState({gemini:"",chatgpt:"",claude:""}),[l,d]=e.useState("tone"),[c,p]=e.useState(!0),u=e.useCallback(async()=>{p(!0);try{const e=await t.getAll();a(e.settings),d(e.lastUsedTab);const o={gemini:e.apiKeys.gemini?await n(e.apiKeys.gemini):"",chatgpt:e.apiKeys.chatgpt?await n(e.apiKeys.chatgpt):"",claude:e.apiKeys.claude?await n(e.apiKeys.claude):""};i(o)}catch(e){}finally{p(!1)}},[]);return e.useEffect(()=>{u()},[u]),{settings:o,apiKeys:r,lastUsedTab:l,isLoading:c,updateSettings:async e=>{await t.updateSettings(e),a(t=>t?{...t,...e}:null)},updateApiKey:async(e,o)=>{const a=await s(o);await t.saveApiKey(e,a),i(t=>({...t,[e]:o}))},updateLastUsedTab:async e=>{await t.update({lastUsedTab:e}),d(e)},refresh:u}}(),{execute:y,loadingState:m,error:h}=u(),[j,k]=e.useState(""),[w,v]=e.useState(null),[S,T]=e.useState(null),[C,R]=e.useState("tone"),[E,I]=e.useState("formal"),[N,A]=e.useState("ko"),[B,M]=e.useState(""),[z,L]=e.useState(""),[K,O]=e.useState(!1),[W,F]=e.useState("KO"),[P,U]=e.useState(!1);e.useEffect(()=>{a&&(A(a.translation.defaultTargetLanguage),R(i),I(a.autoCopyTone||"formal"))},[a?.translation.defaultTargetLanguage,i,a?.autoCopyTone]),e.useEffect(()=>{(async()=>{if(p||!a)return;const e=await chrome.storage.local.get(["lastCommand","commandTimestamp"]),t=Date.now();if(e.lastCommand&&e.commandTimestamp&&t-e.commandTimestamp<5e3){const t=await d();t&&(k(t),_(t),"translation"===e.lastCommand?(R("translation"),await b("translation"),await H(t,"translation")):"tone-conversion"!==e.lastCommand&&"_execute_action"!==e.lastCommand||(R("tone"),await b("tone"),await H(t,"tone"))),await chrome.storage.local.remove(["lastCommand","commandTimestamp"])}else if(!j){const e=await d();e&&(k(e),_(e))}})()},[p,a]);const _=e=>{/[\uAC00-\uD7AF]/.test(e)?F("KO"):/[\u3040-\u309F\u30A0-\u30FF]/.test(e)?F("JA"):/[\u4E00-\u9FFF]/.test(e)?F("ZH"):F("EN")},H=async(e,t)=>{const o=e||j,n=t||C;if(!o.trim()||!a)return void D("ë‚´ìš©ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.","error");const s=r[a.selectedProvider];if(!s)return void D(`${a.selectedProvider} API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`,"error");const i=await y(o,"tone"===n?"tone-conversion":"translation",{provider:a.selectedProvider,model:a.providerModels[a.selectedProvider],apiKey:s,targetLanguage:"translation"===n?N:void 0,tone:"tone"===n?E:void 0});if(i){if("tone"===n){const e=i;v(e),a.autoCopyEnabled&&e[E]&&(await c(e[E]),D("âœ¨ ë³€í™˜ ë° ë³µì‚¬ ì™„ë£Œ","success"))}else T(i),D("âœ¨ ë²ˆì—­ ì™„ë£Œ","success");await l({provider:a.selectedProvider,model:a.providerModels[a.selectedProvider],task:"tone"===n?"tone-conversion":"translation",inputTokens:Math.ceil(.75*o.length),outputTokens:Math.ceil(.75*("string"==typeof i?i.length:JSON.stringify(i).length))})}},D=(e,t)=>{M(e),L(t),"success"===t&&setTimeout(()=>{M(""),L("")},2e3)},J=async()=>{const e="tone"===C?w?.[E]:S;if(e)try{await c(e),O(!0),D("âœ¨ ë³µì‚¬ ì™„ë£Œ","success"),setTimeout(()=>O(!1),2e3)}catch{D("í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}},q=e=>{R(e),b(e)},G="tone"===C?w?.[E]:S;return p?o.jsxs("div",{style:g.loading,children:[o.jsx("div",{style:g.spinner}),o.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):o.jsxs("div",{style:g.popupContainer,children:[o.jsxs("header",{style:g.dragHeader,children:[o.jsxs("div",{style:g.headerLeft,children:[o.jsx("i",{className:"fa-solid fa-grip-vertical",style:{color:"#cbd5e1",marginRight:"4px"}}),o.jsx("div",{style:g.logoBox,children:o.jsx("i",{className:"fa-solid fa-wand-magic-sparkles",style:{color:"white",fontSize:"12px"}})}),o.jsxs("h1",{style:g.title,children:["Nexus AI ",o.jsx("span",{style:{color:"#2563eb"},children:"BCA"})]})]}),o.jsxs("div",{style:g.headerRight,children:[B&&o.jsxs("div",{style:{...g.statusMessage,..."success"===z?g.statusSuccess:g.statusError},children:[o.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B}),"error"===z&&o.jsx("button",{onClick:()=>{M(""),L("")},style:{background:"none",border:"none",cursor:"pointer",padding:0,color:"inherit"},children:"âœ•"})]}),o.jsx("button",{onClick:()=>{"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open("../options/index.html","_blank")},style:g.iconButton,onMouseEnter:e=>{e.currentTarget.style.background="#f8fafc",e.currentTarget.style.color="#475569"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},children:o.jsx("i",{className:"fa-solid fa-gear"})}),o.jsx("button",{style:g.iconButton,onClick:()=>window.close(),onMouseEnter:e=>{e.currentTarget.style.background="#fef2f2",e.currentTarget.style.color="#ef4444"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#94a3b8"},children:o.jsx("i",{className:"fa-solid fa-xmark"})})]})]}),o.jsxs("main",{style:g.scrollableMain,className:"custom-scrollbar",children:[o.jsxs("section",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[o.jsxs("nav",{style:g.nav,children:[o.jsxs("button",{id:"btn-tone",onClick:()=>q("tone"),disabled:"loading"===m,style:{...g.modeTab,..."tone"===C?g.modeTabActive:{}},children:[o.jsx("i",{className:"fa-solid fa-bullhorn",style:{opacity:.7}}),"í†¤ ë³€í™˜"]}),o.jsxs("button",{id:"btn-translate",onClick:()=>q("translation"),disabled:"loading"===m,style:{...g.modeTab,..."translation"===C?g.modeTabActive:{}},children:[o.jsx("i",{className:"fa-solid fa-language",style:{opacity:.7}}),"AI ë²ˆì—­"]})]}),o.jsx("div",{id:"options-panel",style:g.optionsPanel,children:o.jsx("div",{id:"tone-options",style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:("tone"===C?f:x).map(e=>o.jsxs("button",{onClick:()=>"tone"===C?I(e.key):A(e.key),style:{...g.optionChip,...("tone"===C?E===e.key:N===e.key)?g.optionChipActive:{}},children:[o.jsx("span",{style:{fontSize:"14px"},children:e.emoji}),e.label]},e.key))})})]}),o.jsxs("section",{children:[o.jsxs("div",{style:g.sectionLabel,children:[o.jsx("span",{style:g.labelText,children:"Original Text"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[o.jsxs("span",{style:{fontSize:"10px",color:"#94a3b8",fontWeight:500},children:[W," ê°ì§€ë¨"]}),o.jsxs("button",{onClick:async()=>{const e=await d();e&&(k(e),_(e))},style:{fontSize:"10px",color:"#3b82f6",fontWeight:500,background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[o.jsx("i",{className:"fa-regular fa-clipboard",style:{fontSize:"10px"}}),"ë¶™ì—¬ë„£ê¸°"]})]})]}),o.jsx("textarea",{id:"source-textarea",value:j,onChange:e=>{k(e.target.value),_(e.target.value)},style:{...g.inputBoxShared,...g.inputSource},placeholder:"ë³€í™˜í•˜ê³  ì‹¶ì€ ë¬¸ìž¥ì„ ìž…ë ¥í•˜ì„¸ìš”...",onFocus:e=>{e.currentTarget.style.borderColor="#3b82f6",e.currentTarget.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#e2e8f0",e.currentTarget.style.boxShadow="none"}})]}),o.jsxs("section",{children:[o.jsxs("div",{style:g.sectionLabel,children:[o.jsx("span",{style:{...g.labelText,...g.labelTextBlue},children:"AI Result"}),h&&o.jsx("span",{style:{fontSize:"10px",color:"#ef4444",fontWeight:500},children:h})]}),o.jsxs("div",{style:g.resultWrapper,onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:[o.jsx("textarea",{id:"result-textarea",value:"loading"===m?"AIê°€ ì‘ë‹µì„ ìƒì„±í•˜ê³  ìžˆìŠµë‹ˆë‹¤...":G||"",readOnly:!0,style:{...g.inputBoxShared,...g.inputResult,..."loading"===m?{color:"#94a3b8"}:{}},placeholder:"AI ë³€í™˜ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤..."}),G&&"loading"!==m&&o.jsx("div",{style:{...g.copyOverlay,opacity:P?1:0,transition:"opacity 0.2s"},children:o.jsx("button",{onClick:J,style:g.copyButton,onMouseEnter:e=>{e.currentTarget.style.color="#3b82f6",e.currentTarget.style.borderColor="#bfdbfe"},onMouseLeave:e=>{e.currentTarget.style.color="#64748b",e.currentTarget.style.borderColor="#e2e8f0"},children:K?o.jsx("i",{className:"fa-solid fa-check",style:{color:"#22c55e"}}):o.jsx("i",{className:"fa-regular fa-copy"})})})]})]}),o.jsx("div",{style:{height:"8px"}})]}),o.jsxs("footer",{style:g.footer,children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"10px",color:"#94a3b8"},children:[o.jsx("kbd",{style:g.kbd,children:"Alt"}),o.jsx("span",{children:"+"}),o.jsx("kbd",{style:g.kbd,children:"C"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{onClick:()=>window.close(),style:g.cancelButton,onMouseEnter:e=>{e.currentTarget.style.background="#e2e8f0"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:"ì·¨ì†Œ"}),o.jsx("button",{id:"copy-btn",onClick:G?J:()=>H(),disabled:"loading"===m||!j.trim()&&!G,style:{...g.primaryButton,..."loading"===m||!j.trim()&&!G?{opacity:.5,cursor:"not-allowed"}:{}},onMouseEnter:e=>{e.currentTarget.disabled||(e.currentTarget.style.background="#1d4ed8")},onMouseLeave:e=>{e.currentTarget.style.background="#2563eb"},children:"loading"===m?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{width:"12px",height:"12px",border:"2px solid rgba(255,255,255,0.3)",borderTopColor:"#ffffff",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),"ì²˜ë¦¬ ì¤‘..."]}):G?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fa-solid fa-copy"}),"ê²°ê³¼ ë³µì‚¬í•˜ê¸°"]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fa-solid fa-bolt"}),"tone"===C?"ë³€í™˜ ì‹¤í–‰":"ë²ˆì—­ ì‹¤í–‰"]})})]})]}),o.jsx("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 5px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: transparent;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #e2e8f0;\n          border-radius: 10px;\n        }\n      "})]})}a.createRoot(document.getElementById("root")).render(o.jsx(r.StrictMode,{children:o.jsx(b,{})}));
