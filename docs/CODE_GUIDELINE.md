# 코드 가이드라인: 정중한 문장 도우미 (business-message)

> **문서 버전:** 1.0  
> **기준 문서:** PRD v1.0, TRD v1.0  
> **작성일:** 2025-08-30

## 1. 개요

이 문서는 '정중한 문장 도우미' 크롬 확장 프로그램 개발에 참여하는 모든 개발자가 따라야 할 코딩 스타일, 규칙, 모범 사례를 정의합니다. 본 가이드라인의 목표는 코드의 **일관성**, **가독성**, **유지보수성**을 높이고, 잠재적인 오류를 최소화하는 것입니다.

모든 코드는 PRD와 TRD에 명시된 요구사항을 충실히 따라야 합니다.

-----

## 2. 일반 원칙

  - **단일 책임 원칙 (Single Responsibility Principle):** 각 함수와 컴포넌트는 하나의 명확한 기능만 담당하도록 작성합니다.
  - **가독성 우선:** 코드는 실행되는 것만큼이나 쉽게 읽을 수 있어야 합니다. 명확한 변수명과 함수명을 사용하고, 복잡한 로직에는 주석을 추가합니다.
  - **보안 최우선:** 사용자의 데이터(API 키, 입력 텍스트)를 최우선으로 보호합니다. TRD의 보안 요구사항을 반드시 준수합니다.
  - **성능 최적화:** TRD에 명시된 성능 요구사항(로딩 속도, API 응답 시간)을 항상 염두에 두고 개발합니다.

-----

## 3. 개발 환경

  - **Node.js:** v20.x 이상
  - **Package Manager:** `npm` v10.x 이상
  - **설치:** 프로젝트 루트에서 `npm install`을 실행하여 모든 의존성을 설치합니다.
  - **실행:** `npm run dev` 명령어로 개발 서버를 실행합니다.

-----

## 4. 코딩 스타일 및 컨벤션

### 4.1. 포맷팅 (Formatting)

  - 프로젝트에는 **ESLint**와 **Prettier**가 설정되어 있습니다.
  - 모든 코드는 커밋 전에 `lint` 규칙을 통과해야 합니다.
  - IDE에 ESLint 및 Prettier 확장 프로그램을 설치하여 실시간으로 규칙을 적용하는 것을 권장합니다.

### 4.2. 네이밍 컨벤션 (Naming Convention)

  - **변수, 함수:** `camelCase` (e.g., `userApiKey`, `fetchResults`)
  - **컴포넌트, 타입, 인터페이스:** `PascalCase` (e.g., `ResultCard`, `AppStorage`)
  - **상수:** `UPPER_SNAKE_CASE` (e.g., `API_ENDPOINT`, `MAX_USAGE_COUNT`)
  - **파일:** 컴포넌트 파일은 `PascalCase` (e.g., `ResultCard.tsx`), 그 외 파일은 `camelCase` (e.g., `api.ts`)를 사용합니다.

### 4.3. 주석 (Comments)

  - `//`: 간단한 한 줄 주석에 사용합니다.
  - `/** */`: JSDoc 형식으로 함수, 컴포넌트의 목적, 파라미터, 반환 값 등을 설명할 때 사용합니다.
  - 복잡하거나 직관적이지 않은 코드 블록 위에는 해당 로직을 설명하는 주석을 반드시 추가합니다.

-----

## 5. 프론트엔드 (React & TypeScript)

### 5.1. 언어

  - **TypeScript**를 사용하며, `tsconfig.json`의 `strict: true` 옵션을 반드시 준수합니다.
  - `any` 타입의 사용은 지양하고, 불가피할 경우 명확한 사유를 주석으로 남깁니다.

### 5.2. 컴포넌트

  - **구조:** TRD에 정의된 컴포넌트 구조(`Popup`, `Settings`, `ResultCard` 등)를 따릅니다.
  - **재사용성:** 두 번 이상 사용되는 UI 요소는 재사용 가능한 컴포넌트로 분리합니다.
  - **Props:** 모든 컴포넌트의 `props`는 `interface` 또는 `type`으로 명확하게 타입을 정의해야 합니다.
  - **상태 관리:** MVP 단계에서는 **React Hooks (`useState`, `useReducer`, `useContext`)** 만을 사용하여 상태를 관리합니다. Redux, Zustand 등 외부 상태 관리 라이브러리는 도입하지 않습니다.

### 5.3. 스타일링

  - **CSS Modules** 또는 **Styled-Components**를 사용하여 컴포넌트 스코프의 스타일을 유지합니다.
  - 전역 스타일은 `styles/global.css`에 최소한으로 정의합니다.
  - 디자인 시스템이 정의되지 않았으므로, 일관된 UI를 위해 기존 컴포넌트의 스타일을 참고하여 작성합니다.

-----

## 6. API 연동

  - **모듈화:** 모든 Google Gemini API 관련 로직은 **`src/utils/api.ts`** 파일 내에 함수로 캡슐화합니다. 컴포넌트에서 직접 `fetch`를 호출하지 않습니다.
  - **시스템 프롬프트:** API 요청 시 TRD 4.3절에 명시된 **시스템 프롬프트를 수정 없이 그대로 사용**해야 합니다. 이는 결과의 일관성을 보장하기 위함입니다.
  - **요청/응답 타입:** API 요청 본문과 응답 데이터의 타입은 `src/types/index.ts`에 `interface`로 정의하여 사용합니다.

<!-- end list -->

```typescript
// src/types/index.ts 예시
export interface GeminiApiResponse {
  formal: string;
  general: string;
  friendly: string;
}
```

-----

## 7. 데이터 및 보안

  - **데이터 저장:**

      - 모든 로컬 데이터는 `chrome.storage.local` API를 통해서만 읽고 써야 합니다.
      - `src/utils/storage.ts`에 정의된 래퍼(wrapper) 함수를 통해서만 스토리지에 접근합니다.
      - TRD 5절의 `AppStorage` 스키마를 반드시 준수해야 합니다.

  - **API 키 보안:**

      - 사용자의 API 키는 **`Web Crypto API (AES-GCM)`** 를 사용하여 **반드시 암호화**한 후 `storage.local`에 저장해야 합니다.
      - 암호화 및 복호화 로직은 `src/utils/crypto.ts`에 구현합니다.

  - **데이터 처리:**

      - **절대 금지:** 사용자가 입력한 텍스트 및 AI가 변환한 결과를 `storage.local` 또는 외부 서버에 저장해서는 안 됩니다. 데이터는 오직 메모리에서만 휘발성으로 처리합니다.
      - **절대 금지:** 개발 중 민감한 정보(API 키, 사용자 입력 텍스트)를 `console.log`로 출력하지 마십시오.

-----

## 8. 에러 핸들링

  - TRD 7절에 명시된 **모든 에러 상황에 대한 처리 로직을 구현**해야 합니다.
  - API 호출 등 비동기 작업은 `try...catch` 블록으로 감싸 예외를 처리합니다.
  - 사용자에게 보여지는 에러 메시지는 명확하고 이해하기 쉬워야 합니다.
  - React의 **Error Boundaries**를 최상위 컴포넌트에 적용하여 렌더링 중 발생하는 예외를 처리하는 것을 권장합니다.

-----

## 9. Git 및 버전 관리

### 9.1. 브랜치 전략

  - **`main`:** 배포 가능한 안정 버전의 코드만 포함합니다.
  - **`develop`:** 개발 중인 최신 코드를 포함하는 통합 브랜치입니다.
  - **`feature/기능-이름`:** 새로운 기능을 개발할 때 `develop` 브랜치에서 생성합니다. (e.g., `feature/api-key-validation`)
  - **`fix/수정-내용`:** 버그를 수정할 때 `develop` 브랜치에서 생성합니다.

### 9.2. 커밋 메시지

**Conventional Commits** 규칙을 따릅니다. 커밋 메시지는 어떤 작업을 했는지 명확히 알 수 있도록 작성합니다.

  - **`feat`:** 새로운 기능 추가
  - **`fix`:** 버그 수정
  - **`docs`:** 문서 수정
  - **`style`:** 코드 포맷팅, 세미콜론 누락 등 (코드 변경 없음)
  - **`refactor`:** 코드 리팩토링
  - **`test`:** 테스트 코드 추가/수정
  - **`chore`:** 빌드, 패키지 매니저 설정 등

**예시:**

```
feat: API 키 유효성 검사 기능 추가
fix: 클립보드가 비어있을 때 발생하는 오류 수정
docs: README.md 파일에 개발 환경 설정 방법 업데이트
```