# 기능 상세 스펙 문서 - 00. 개요 및 시스템 아키텍처

> **문서 버전**: 2.2  
> **작성일**: 2025-12-25  
> **업데이트**: 2025-12-25 - 번역 기능 및 Content Script 아키텍처 추가
> **프로젝트**: 비즈니스 커뮤니케이션 어시스턴트 (Business Communication Assistant)

---

## 목차

1. [시스템 개요](#1-시스템-개요)
2. [전체 아키텍처](#2-전체-아키텍처)
3. [기술 스택](#3-기술-스택)
4. [디렉토리 구조](#4-디렉토리-구조)
5. [데이터 흐름](#5-데이터-흐름)
6. [보안 아키텍처](#6-보안-아키텍처)
7. [성능 요구사항](#7-성능-요구사항)
8. [배포 환경](#8-배포-환경)

---

## 1. 시스템 개요

### 1.1 프로젝트 정보

**프로젝트명**: 비즈니스 커뮤니케이션 어시스턴트 (Business Communication Assistant)  
**버전**: 2.2.0  
**플랫폼**: Chrome Extension (Manifest V3)  
**개발 상태**: v2.2 개발 중 (번역 기능 및 멀티 AI 지원 통합)

### 1.2 목적 및 목표

**핵심 목적**:
- 한국 직장 문화에 맞는 적절한 톤앤매너의 문장 작성 지원
- **AI 기반 전문 번역(즉시 대체)** 기능을 통한 다국어 소통 지원
- 클립보드 및 웹페이지 텍스트 조작을 통한 생산성 극대화

**비즈니스 목표**:
- 사용자의 문장 작성 및 번역 시간 95% 단축
- 출시 3개월 내 일일 활성 사용자(DAU) 3,000명 달성
- 팝업 로딩 300ms 이내, 번역/변환 API 응답 2초 이하 유지

### 1.3 핵심 기능

1. **정중한 문장 변환**: 3가지 톤(격식, 일반, 친근) 자동 변환
2. **즉시 번역 (Instant Translation)**: 텍스트 선택 후 설정한 단축키 입력 시 즉시 번역문으로 대체
3. **다중 AI 지원**: Google Gemini, OpenAI, Anthropic(Claude) API 키 지원
5. **형식 유지**: 줄바꿈(`\n`) 및 HTML 레이아웃을 완벽하게 보존하는 번역 로직

---

## 2. 전체 아키텍처

### 2.1 시스템 아키텍처 다이어그램

```
┌────────────────────────────────────────────────────────────┐
│                  User's Chrome Browser                     │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐  │
│  │         Chrome Extension (React SPA & Scripts)       │  │
│  │                                                      │  │
│  │  ┌─────────────┐         ┌──────────────┐          │  │
│  │  │  Popup UI   │         │ Options UI   │          │  │
│  │  │  (Tabs)     │         │ (Settings)   │          │  │
│  │  └──────┬──────┘         └──────┬───────┘          │  │
│  │         │                       │                   │  │
│  │         └───────────┬───────────┘                   │  │
│  │                     ↓                               │  │
│  │         ┌────────────────────────┐                  │  │
│  │         │   Background Service   │                  │  │
│  │         ├────────────────────────┤                  │  │
│  │         │ - Command Handling     │                  │  │
│  │         │ - AI Core Service      │                  │  │
│  │         │ - Storage & Crypto     │                  │  │
│  │         └──────────┬─────┬───────┘                  │  │
│  │                    │     │                          │  │
│  │                    │     ↓                          │  │
    │  │                    │  ┌────────────────────────┐    │  │
    │  │                    │  │    Content Scripts     │    │  │
    │  │                    │  ├────────────────────────┤    │  │
    │  │                    │  │ - Text Selection        │    │  │
    │  │                    │  │ - DOM Replacement      │    │  │
    │  │                    │  └────────────────────────┘    │  │
    │  └────────────────────┼────────────────────────────────┘  │
│                       │                                   │
│         ┌─────────────┴──────────────┐                    │
│         ↓                            ↓                    │
│  ┌──────────────┐          ┌─────────────────┐           │
│  │ Chrome APIs  │          │ Chrome Storage  │           │
│  │ - activeTab  │          │ (Local)         │           │
│  │ - scripting  │          │ - Encrypted     │           │
│  └──────────────┘          └─────────────────┘           │
└────────────────────────────────────────────────────────────┘
```

### 2.2 컴포넌트 및 스크립트 구조

```
App Layer (UI Components)
├── Popup (Tab Layout)
│   ├── App.tsx (Tabs: Tone / Translation)
│   ├── ToneTab (Existing logic)
│   └── TranslationTab (Manual Input)
└── Options
    └── Settings.tsx (Multi-Provider Settings)

Extension Layer (Background & Content)
├── Background Script (Service Worker)
│   ├── commands.ts (Shortcuts handler)
│   └── ai-service.ts (Unified AI Interface)
└── Content Scripts
    ├── replacer.ts (Instant Replacement)
    └── toast.ts (Error notifications)

Service Layer (Business Logic)
├── AI Core (api.ts)
│   ├── Gemini / OpenAI / Claude Wrappers
│   └── Prompt Engineering (Line-break preservation)
├── Storage & Crypto
│   ├── AES-GCM Encryption
│   └── Translation Settings Schema
└── DOM Utils
    └── Selection API
```

---

## 3. 기술 스택

### 3.1 프론트엔드

| 기술 | 용도 |
|------|------|
| **React 18** | UI 라이브러리 |
| **TypeScript** | 타입 안정성 |
| **Vite** | 빌드 도구 |
| **Tailwind CSS** | 스타일링 |
| **shadcn/ui** | UI 컴포넌트 라이브러리 |

### 3.2 Chrome Extension

| 기술 | 용도 |
|------|------|
| **Manifest V3** | Chrome Extension 표준 |
| **Scripting API** | 페이지 내 스크립트 실행 및 DOM 조작 |
| **Commands API** | 전역 단축키 처리 |

### 3.3 외부 API (AI Engines)

| 서비스 | 모델 | 용도 |
|--------|------|------|
| **Google Gemini** | gemini-2.5-flash | 고속 변환 및 무료 할당량 |
| **OpenAI** | gpt-5 | 정밀한 변환 및 번역 |
| **Anthropic** | claude-4-5-haiku | 자연스러운 문체 및 긴 문맥 |

---

## 4. 디렉토리 구조 (v2.2 확장)

```
business-message/
├── src/
│   ├── content/            # 신규: Content Scripts
│   │   ├── replacer.ts     # 즉시 번역 처리
│   │   └── toast.ts        # 오류 알림
│   ├── background/         # 신규: Background Script
│   │   ├── index.ts        # 메인 엔트리
│   │   └── commands.ts     # 단축키 리스너
│   ├── popup/              # 팝업 UI (탭 구조로 변경)
│   ├── options/            # 설정 UI (멀티 AI 설정)
│   ├── utils/              # 공통 유틸리티
│   │   ├── ai-service.ts   # 통합 AI 인터페이스
│   │   └── translation.ts  # 번역 특화 로직
│   └── types/              # 신규 타입 정의
```

---

## 5. 데이터 흐름

### 5.1 즉시 번역 플로우

1. 사용자가 웹페이지에서 텍스트 선택 후 단축키 입력
2. Background에서 단축키 감지 → 현재 탭의 Content Script로 명령 전송
3. Content Script가 선택된 텍스트 추출 → Background로 전달
4. Background에서 설정된 AI Provider(Gemini/OpenAI/Claude)를 통해 번역 수행
5. 번역 결과를 Content Script로 전송 → 선택 영역을 번역문으로 교체
6. 실패 시에만 토스트 알림 표시

---

## 6. 보안 및 성능

### 6.1 보안 (암호화)
- 모든 API 키는 **AES-GCM 256-bit** 암호화 후 `chrome.storage.local`에 저장
- 통신은 오직 공식 AI API 엔드포인트와 HTTPS를 통해서만 수행

### 6.2 성능 목표
- 번역/변환 API 응답: 2초 이내
- DOM 조작 및 대체: 100ms 이내
- 메모리 사용량: 50MB 미만 유지

---

**문서 작성**: BCA 개발팀  
**최종 업데이트**: 2025-12-25
