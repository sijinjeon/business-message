import{c as e,r as s,j as t,a,i as r,B as n,C as i,S as l,f as o,d as c,M as d,e as x,L as m,g as p,h as u,R as f}from"./storage-service-FUU9XJQq.js";import{d as h,e as g,A as b}from"./crypto-DogMPkOD.js";import{l as v}from"./storage-DQogxH6w.js";/* empty css               */
/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=e("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),j=e("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]),y=e("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),N=e("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),z=s.forwardRef(({className:e,...s},r)=>t.jsx("textarea",{className:a("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-4 py-3 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));z.displayName="Textarea";const k=r.memo(({value:e,onChange:s,maxLength:a,placeholder:r})=>{const n=e.length,i=a>0,l=i&&n>a;return t.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[t.jsxs("div",{className:"relative group flex-1 flex flex-col min-h-0",children:[t.jsx(z,{value:e,onChange:e=>s(e.target.value),placeholder:r,className:"flex-1 min-h-0 resize-none p-5 rounded-2xl bg-zinc-50/50 border-zinc-100 transition-all duration-300 focus-visible:ring-zinc-900/5 focus-visible:ring-offset-0 focus-visible:border-zinc-300 focus-visible:bg-white font-sans text-[15px] leading-relaxed "+(l?"border-destructive focus-visible:border-destructive focus-visible:ring-destructive/10":""),maxLength:i?a+50:void 0}),t.jsx("div",{className:"absolute bottom-4 right-4 flex items-center gap-2",children:t.jsxs("span",{className:"text-[11px] font-bold px-2 py-1 rounded-md bg-white border border-zinc-200/50 shadow-sm "+(l?"text-destructive border-destructive/20 bg-destructive/5":"text-zinc-400"),children:[n.toLocaleString(),i?` / ${a}`:" 자"]})})]}),l&&t.jsxs("p",{className:"text-[12px] text-destructive mt-2 font-medium px-1 animate-in fade-in slide-in-from-top-1",children:["글자 수가 제한을 초과했습니다. ",a,"자 이내로 줄여주세요."]})]})}),C=s.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:a("rounded-xl border bg-card text-card-foreground shadow",e),...s}));C.displayName="Card";const T=s.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:a("flex flex-col space-y-1.5 p-6",e),...s}));T.displayName="CardHeader";const S=s.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:a("font-semibold leading-none tracking-tight",e),...s}));S.displayName="CardTitle";s.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:a("text-sm text-muted-foreground",e),...s})).displayName="CardDescription";const R=s.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:a("p-6 pt-0",e),...s}));R.displayName="CardContent";s.forwardRef(({className:e,...s},r)=>t.jsx("div",{ref:r,className:a("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";const E={formal:"비즈니스 이메일",general:"사내 메신저",friendly:"캐주얼 채팅"},L=r.memo(({tone:e,text:a,onCopy:r,isDefaultSelected:l=!1,onConvert:o,isLoading:c=!1})=>{const[d,x]=s.useState(!1),m=E[e];return t.jsxs(C,{className:"group relative transition-all duration-300 rounded-2xl border-zinc-100 shadow-none "+(l?"bg-zinc-50/80 border-zinc-200":"bg-white hover:bg-zinc-50/30 hover:border-zinc-200"),children:[t.jsxs(T,{className:"pb-2 px-4 pt-3 flex-row items-center justify-between space-y-0",children:[t.jsxs(S,{className:"text-[13px] font-bold flex items-center gap-2 text-zinc-800",children:[t.jsx("span",{className:"w-1.5 h-1.5 rounded-full "+(l?"bg-zinc-900":"bg-zinc-200")}),m]}),t.jsxs("div",{className:"flex items-center gap-1",children:[l&&t.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase tracking-tight mr-1",children:"Default"}),a&&t.jsx(n,{variant:"ghost",size:"sm",onClick:async()=>{if(a)try{await r(a),x(!0),setTimeout(()=>x(!1),2e3)}catch(e){}},className:"h-7 w-7 p-0 rounded-lg hover:bg-zinc-100 transition-colors",children:d?t.jsx(i,{className:"h-3.5 w-3.5 text-green-600"}):t.jsx(y,{className:"h-3.5 w-3.5 text-zinc-400"})})]})]}),t.jsx(R,{className:"px-4 pb-4 pt-0",children:a?t.jsx("div",{className:"font-sans text-[15px] leading-relaxed text-zinc-600 break-words break-keep-all whitespace-pre-wrap",children:a}):t.jsx("div",{className:"py-2 flex flex-col items-center justify-center border border-dashed border-zinc-200 rounded-xl bg-white/50",children:t.jsxs(n,{variant:"ghost",size:"sm",disabled:c,onClick:()=>o?.(e),className:"text-[12px] font-bold text-zinc-400 hover:text-zinc-900 gap-2 h-8 px-3",children:[c?t.jsx("div",{className:"w-3 h-3 border-2 border-zinc-200 border-t-zinc-900 rounded-full animate-spin"}):t.jsx(N,{className:"w-3 h-3"}),m," 변환"]})})})]})});async function M(){try{if(!navigator.clipboard||!navigator.clipboard.readText)throw new Error("클립보드 접근이 지원되지 않습니다.");return(await navigator.clipboard.readText()).trim()}catch(e){return""}}async function P(e){try{if(!navigator.clipboard||!navigator.clipboard.writeText)throw new Error("클립보드 접근이 지원되지 않습니다.");await navigator.clipboard.writeText(e)}catch(s){throw new Error("클립보드 복사에 실패했습니다.")}}class K extends Error{constructor(e,s,t){super(e),this.code=s,this.userMessage=t,this.name="AppError"}}function A(){const[e,t]=s.useState("idle"),[a,r]=s.useState(null),n=s.useCallback(async(e,s,a)=>{t("loading"),r(null);try{const r=await b.execute(e,s,a);return t("success"),r}catch(n){const e=function(e){return e instanceof K?e:e instanceof Error?e.message.includes("fetch")?new K("Network error","NETWORK_ERROR","네트워크 연결을 확인해주세요."):e.message.includes("429")||e.message.toLowerCase().includes("quota exceeded")?new K("Quota Exceeded","RATE_LIMIT_ERROR","AI 서비스 호출 한도를 초과했습니다. 잠시 후(약 1분) 다시 시도하거나, 설정에서 다른 모델 또는 API 키를 확인해주세요."):new K(e.message,"UNKNOWN_ERROR",e.message||"알 수 없는 오류가 발생했습니다."):new K("Unknown error","UNKNOWN_ERROR","알 수 없는 오류가 발생했습니다.")}(n);return t("error"),r(e.userMessage||e.message),null}},[]);return{execute:n,loadingState:e,error:a,reset:()=>{t("idle"),r(null)}}}function O(){const{settings:e,apiKeys:a,lastUsedTab:r,isLoading:n,updateLastUsedTab:i}=function(){const[e,t]=s.useState(null),[a,r]=s.useState({gemini:"",chatgpt:"",claude:""}),[n,i]=s.useState("tone"),[o,c]=s.useState(!0),d=s.useCallback(async()=>{c(!0);try{const e=await l.getAll();t(e.settings),i(e.lastUsedTab);const s={gemini:e.apiKeys.gemini?await h(e.apiKeys.gemini):"",chatgpt:e.apiKeys.chatgpt?await h(e.apiKeys.chatgpt):"",claude:e.apiKeys.claude?await h(e.apiKeys.claude):""};r(s)}catch(e){}finally{c(!1)}},[]);return s.useEffect(()=>{d()},[d]),{settings:e,apiKeys:a,lastUsedTab:n,isLoading:o,updateSettings:async e=>{await l.updateSettings(e),t(s=>s?{...s,...e}:null)},updateApiKey:async(e,s)=>{const t=await g(s);await l.saveApiKey(e,t),r(t=>({...t,[e]:s}))},updateLastUsedTab:async e=>{await l.update({lastUsedTab:e}),i(e)},refresh:d}}(),{execute:f,loadingState:b,error:y}=A(),[z,C]=s.useState(""),[T,S]=s.useState(null),[R,E]=s.useState({}),[K,O]=s.useState(null),[U,I]=s.useState("tone"),[_,D]=s.useState("ko"),[$,q]=s.useState(""),[B,V]=s.useState("");s.useEffect(()=>{e&&(D(e.translation.defaultTargetLanguage),I(r))},[e?.translation.defaultTargetLanguage,r]),s.useEffect(()=>{(async()=>{if(n||!e)return;const s=await chrome.storage.local.get(["lastCommand","commandTimestamp"]),t=Date.now();if(s.lastCommand&&s.commandTimestamp&&t-s.commandTimestamp<5e3){const e=await M();e&&(C(e),"translation"===s.lastCommand?(I("translation"),await i("translation"),await W(e,"translation")):"tone-conversion"!==s.lastCommand&&"_execute_action"!==s.lastCommand||(I("tone"),await i("tone"),await W(e,"tone"))),await chrome.storage.local.remove(["lastCommand","commandTimestamp"])}else if(!z){const e=await M();e&&C(e)}})()},[n,e]);const W=async(s,t)=>{const r=s||z,n=t||U;if(!r.trim()||!e)return void H("내용을 입력해주세요.","error");const i=a[e.selectedProvider];if(!i)return void H(`${e.selectedProvider} API 키가 설정되지 않았습니다.`,"error");const l=await f(r,"tone"===n?"tone-conversion":"translation",{provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],apiKey:i,targetLanguage:"translation"===n?_:void 0,tone:"tone"===n?e.autoCopyTone:void 0});if(l){if("tone"===n){const s=l;S(s),e.autoCopyEnabled&&s[e.autoCopyTone]&&(await P(s[e.autoCopyTone]),H("✨ 변환 및 복사 완료","success"))}else O(l),H("✨ 번역 완료","success");await v({provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],task:"tone"===n?"tone-conversion":"translation",inputTokens:Math.ceil(.75*r.length),outputTokens:Math.ceil(.75*("string"==typeof l?l.length:JSON.stringify(l).length))})}},F=async s=>{if(!z.trim()||!e)return;const t=a[e.selectedProvider];if(t){E(e=>({...e,[s]:!0}));try{const a=await f(z,"tone-conversion",{provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],apiKey:t,tone:s});if(a){const t=a;S(e=>({...e,...t})),H(`✨ ${"formal"===s?"비즈니스":"general"===s?"사내":"캐주얼"} 스타일 변환 완료`,"success"),await v({provider:e.selectedProvider,model:e.providerModels[e.selectedProvider],task:"tone-conversion",inputTokens:Math.ceil(.75*z.length),outputTokens:Math.ceil(.75*JSON.stringify(a).length)})}}finally{E(e=>({...e,[s]:!1}))}}else H(`${e.selectedProvider} API 키가 설정되지 않았습니다.`,"error")},H=(e,s)=>{q(e),V(s),setTimeout(()=>{q(""),V("")},2e3)};return n?t.jsx("div",{className:"w-[800px] h-[600px] flex items-center justify-center",children:t.jsx(o,{className:"animate-spin text-zinc-400"})}):t.jsxs("div",{className:"w-[800px] h-[600px] bg-white relative flex flex-col overflow-hidden selection:bg-zinc-900/10",children:[t.jsxs("header",{className:"px-6 py-4 flex items-center justify-between border-b border-zinc-100 shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-zinc-900 flex items-center justify-center",children:t.jsx(j,{className:"w-4 h-4 text-white"})}),t.jsx("div",{children:t.jsx("h1",{className:"text-[14px] font-bold tracking-tight text-zinc-900 leading-none",children:"BCA Assistant"})})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[$&&t.jsxs("div",{className:"px-3 py-1.5 rounded-full text-[12px] font-bold animate-in fade-in slide-in-from-right-2 border flex items-center gap-2 "+("success"===B?"bg-green-50 text-green-700 border-green-100":"bg-red-50 text-red-700 border-red-100"),children:["success"===B?t.jsx(N,{className:"w-3 h-3"}):t.jsx(w,{className:"w-3 h-3"}),$]}),t.jsx("button",{onClick:()=>{"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open("../options/index.html","_blank")},className:"p-2 rounded-lg hover:bg-zinc-100 transition-colors text-zinc-400 hover:text-zinc-600",children:t.jsx(c,{className:"w-4 h-4"})})]})]}),t.jsxs("main",{className:"flex-1 flex overflow-hidden",children:[t.jsxs("section",{className:"w-[340px] border-r border-zinc-100 flex flex-col p-5 space-y-4",children:[t.jsx("div",{className:"flex items-center justify-between px-1",children:t.jsxs("h2",{className:"text-[11px] font-bold text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[t.jsx(d,{className:"w-3 h-3"}),"메시지 입력"]})}),t.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:t.jsx(k,{value:z,onChange:C,maxLength:5e3,placeholder:"다듬거나 번역할 메시지를 입력하세요..."})}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("button",{onClick:async()=>{const e=await M();e&&C(e)},className:"w-full py-2.5 rounded-xl border border-zinc-200 text-[13px] font-bold text-zinc-600 hover:bg-zinc-50 transition-all flex items-center justify-center gap-2",children:[t.jsx(x,{className:"w-3.5 h-3.5"}),"클립보드 붙여넣기"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("button",{onClick:()=>{I("tone"),W(z,"tone")},disabled:"loading"===b,className:"py-3 rounded-xl text-[13px] font-bold transition-all flex flex-col items-center gap-1 border "+("tone"===U?"bg-zinc-900 text-white border-zinc-900 shadow-sm":"bg-white text-zinc-600 border-zinc-200 hover:border-zinc-300"),children:[t.jsx(N,{className:"w-4 h-4"}),"톤 변환"]}),t.jsxs("button",{onClick:()=>{I("translation"),W(z,"translation")},disabled:"loading"===b,className:"py-3 rounded-xl text-[13px] font-bold transition-all flex flex-col items-center gap-1 border "+("translation"===U?"bg-zinc-900 text-white border-zinc-900 shadow-sm":"bg-white text-zinc-600 border-zinc-200 hover:border-zinc-300"),children:[t.jsx(m,{className:"w-4 h-4"}),"전문 번역"]})]}),"translation"===U&&t.jsx("div",{className:"pt-2",children:t.jsxs(p,{value:_,onValueChange:e=>D(e),children:[t.jsx(u,{value:"ko",children:"한국어로 번역"}),t.jsx(u,{value:"en",children:"영어로 번역"}),t.jsx(u,{value:"ja",children:"일본어로 번역"}),t.jsx(u,{value:"zh-CN",children:"중국어로 번역"})]})})]})]}),t.jsxs("section",{className:"flex-1 bg-zinc-50/30 flex flex-col overflow-hidden",children:[t.jsx("div",{className:"p-5 flex items-center justify-between border-b border-zinc-100 bg-white/50 backdrop-blur-sm",children:t.jsx("h2",{className:"text-[11px] font-bold text-zinc-400 uppercase tracking-widest",children:"tone"===U?"톤 변환 결과":"번역 결과"})}),t.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-5 flex flex-col",children:[y&&t.jsxs("div",{className:"p-4 rounded-2xl bg-red-50 border border-red-100 text-red-700 mb-4 flex items-start gap-3",children:[t.jsx(w,{className:"w-4 h-4 mt-0.5 shrink-0"}),t.jsx("p",{className:"text-[14px] font-medium",children:y})]}),t.jsxs("div",{className:"h-full",children:["loading"===b?t.jsxs("div",{className:"h-full flex flex-col items-center justify-center py-20 animate-in fade-in duration-500",children:[t.jsx("div",{className:"bca-gradient-spinner mb-4"}),t.jsx("p",{className:"text-[13px] font-bold text-zinc-400 animate-pulse",children:"AI가 응답을 생성하고 있습니다..."})]}):t.jsxs(t.Fragment,{children:["tone"===U&&T&&t.jsxs("div",{className:"space-y-3",children:[t.jsx(L,{tone:"formal",text:T.formal,onCopy:P,isDefaultSelected:"formal"===e?.autoCopyTone,onConvert:F,isLoading:R.formal}),t.jsx(L,{tone:"general",text:T.general,onCopy:P,isDefaultSelected:"general"===e?.autoCopyTone,onConvert:F,isLoading:R.general}),t.jsx(L,{tone:"friendly",text:T.friendly,onCopy:P,isDefaultSelected:"friendly"===e?.autoCopyTone,onConvert:F,isLoading:R.friendly})]}),"translation"===U&&K&&t.jsxs("div",{className:"p-6 rounded-2xl border border-zinc-100 bg-white space-y-4 shadow-sm",children:[t.jsx("p",{className:"font-sans text-[15px] leading-relaxed text-zinc-900 whitespace-pre-wrap",children:K}),t.jsx("div",{className:"flex justify-end border-t border-zinc-50 pt-4",children:t.jsxs("button",{onClick:()=>{P(K),H("✨ 복사 완료","success")},className:"px-4 py-2 bg-zinc-900 text-white rounded-xl text-[12px] font-bold hover:bg-zinc-800 transition-colors flex items-center gap-2",children:[t.jsx(x,{className:"w-3.5 h-3.5"}),"클립보드에 복사"]})})]})]}),"idle"===b&&!T&&!K&&t.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-zinc-300 py-20",children:[t.jsx(N,{className:"w-10 h-10 mb-4 opacity-10"}),t.jsx("p",{className:"text-[13px] font-medium",children:"변환 또는 번역을 선택해주세요."})]})]})]})]})]}),t.jsxs("footer",{className:"px-6 py-3 border-t border-zinc-50 flex items-center justify-between text-[10px] text-zinc-400 font-bold uppercase tracking-widest shrink-0 bg-white",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-3 h-3"}),"Secured by ",e?.selectedProvider.toUpperCase()||"AI"]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsx("span",{children:"v2.3.0"})})]})]})}f.createRoot(document.getElementById("root")).render(t.jsx(r.StrictMode,{children:t.jsx(O,{})}));
