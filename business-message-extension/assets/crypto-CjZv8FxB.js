async function e(){const e=chrome.runtime.id,t=new TextEncoder,r=await crypto.subtle.importKey("raw",t.encode(e+"business-message-helper"),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t.encode("business-message-salt"),iterations:1e5,hash:"SHA-256"},r,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function t(t){try{const r=await e(),n=(new TextEncoder).encode(t),a=crypto.getRandomValues(new Uint8Array(12)),c=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},r,n),o=new Uint8Array(a.length+c.byteLength);return o.set(a),o.set(new Uint8Array(c),a.length),btoa(String.fromCharCode(...o))}catch(r){throw new Error("데이터 암호화에 실패했습니다.")}}async function r(t){try{const r=await e(),n=Uint8Array.from(atob(t),e=>e.charCodeAt(0)),a=n.slice(0,12),c=n.slice(12),o=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},r,c);return(new TextDecoder).decode(o)}catch(r){throw new Error("데이터 복호화에 실패했습니다.")}}export{r as decryptData,t as encryptData};
