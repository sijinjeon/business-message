const e={},t=function(t,n,s){let a=Promise.resolve();if(n&&n.length>0){let t=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};const o=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),i=r?.nonce||r?.getAttribute("nonce");a=t(n.map(t=>{if(t=function(e,t){return new URL(e,t).href}(t,s),t in e)return;e[t]=!0;const n=t.endsWith(".css"),a=n?'[rel="stylesheet"]':"";if(!!s)for(let e=o.length-1;e>=0;e--){const s=o[e];if(s.href===t&&(!n||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${t}"]${a}`))return;const r=document.createElement("link");return r.rel=n?"stylesheet":"modulepreload",n||(r.as="script"),r.crossOrigin="",r.href=t,i&&r.setAttribute("nonce",i),document.head.appendChild(r),n?new Promise((e,n)=>{r.addEventListener("load",e),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${t}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(e=>{for(const t of e||[])"rejected"===t.status&&o(t.reason);return t().catch(o)})},n={apiKeys:{gemini:"",chatgpt:"",claude:""},dailyUsage:{date:(new Date).toISOString().split("T")[0],count:0},usageLogs:[],settings:{selectedProvider:"gemini",providerModels:{gemini:"gemini-3-flash",chatgpt:"gpt-5.2",claude:"claude-4-5-sonnet"},temperature:.7,maxOutputTokens:1024,autoCopyEnabled:!0,autoCopyTone:"formal",instantToneStyle:"formal",translation:{defaultTargetLanguage:"ko",preserveLineBreaks:!0,showNotification:!0}},lastUsedTab:"tone"};async function s(){try{const e=await chrome.storage.local.get(null),t={...n,...e};return t.usageLogs||(t.usageLogs=[]),t.settings={...n.settings,...e.settings},t.settings.translation={...n.settings.translation,...e.settings?.translation},t.settings.providerModels={...n.settings.providerModels,...e.settings?.providerModels},t}catch(e){return n}}async function a(e){try{await chrome.storage.local.set(e)}catch(t){throw new Error("데이터 저장에 실패했습니다.")}}async function o(e){const n=await s(),{AI_MODELS:o}=await t(async()=>{const{AI_MODELS:e}=await import("./models-CtQ6fdnb.js");return{AI_MODELS:e}},[],import.meta.url),r=(o[e.provider]||[]).find(t=>t.id===e.model),i=r?.pricePer1M||0,l=((e.inputTokens||0)+(e.outputTokens||0))/1e6*i,c=[{timestamp:Date.now(),...e,cost:l},...n.usageLogs||[]].slice(0,1e3);await a({usageLogs:c}),await async function(){const e=await s(),t=(new Date).toISOString().split("T")[0];let n=1;e.dailyUsage.date===t&&(n=e.dailyUsage.count+1);return await a({dailyUsage:{date:t,count:n}}),n}()}export{s as g,o as l};
